import pandas as pdimport numpy as npimport matplotlib.pyplot as pltfrom sklearn import datasetsfrom sklearn.model_selection import train_test_splitfrom sklearn.tree import DecisionTreeClassifier, plot_treefrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report# -----------------------------# Step 1: Load Dataset# -----------------------------iris = datasets.load_iris()X = iris.datay = iris.targetdf = pd.DataFrame(X, columns=iris.feature_names)df['species'] = iris.target_names[y]print("Dataset Sample:")print(df.head())
# -----------------------------# Step 2: Split Data# -----------------------------X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)# -----------------------------# Step 3: Train Decision Tree Model# -----------------------------# criterion can be 'gini' or 'entropy'clf = DecisionTreeClassifier(criterion='entropy', random_state=42)clf.fit(X_train, y_train)# -----------------------------# Step 4: Make Predictions# -----------------------------y_pred = clf.predict(X_test)# -----------------------------# Step 5: Evaluate Model# -----------------------------print("\n=== Model Evaluation ===")print("Accuracy:", accuracy_score(y_test, y_pred))print("\nConfusion Matrix:\n", confusion_matrix(y_test, y_pred))print("\nClassification Report:\n", classification_report(y_test, y_pred, target_names=iris.target_names))# -----------------------------# Step 6: Visualize Decision Tree# -----------------------------plt.figure(figsize=(14, 8))plot_tree(clf, feature_names=iris.feature_names, class_names=iris.target_names, filled=True, rounded=True)plt.title("Decision Tree Visualization (Iris Dataset)")plt.show()

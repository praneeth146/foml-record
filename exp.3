import numpy as npimport pandas as pdimport matplotlib.pyplot as pltfrom sklearn.model_selection import train_test_splitfrom sklearn.linear_model import LogisticRegressionfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report# -----------------------------# Step 1: Create or Load Data# -----------------------------# Example dataset: Hours studied vs Pass(1)/Fail(0)data = { 'Hours_Studied': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], 'Pass': [0, 0, 0, 0, 1, 1, 1, 1, 1, 1]}df = pd.DataFrame(data)print("Dataset:\n", df)
# -----------------------------# Step 2: Split Data# -----------------------------x = df[['Hours_Studied']] # Independent variabley = df['Pass'] # Dependent variable (binary)x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=0)# -----------------------------# Step 3: Train Logistic Model# -----------------------------model = LogisticRegression()model.fit(x_train, y_train)# -----------------------------# Step 4: Make Predictions# -----------------------------y_pred = model.predict(x_test)y_prob = model.predict_proba(x_test)[:, 1] # Probability of class 1print("\nPredicted Values:", y_pred)print("Predicted Probabilities:", np.round(y_prob, 2))# -----------------------------# Step 5: Model Evaluation# -----------------------------print("\n=== Model Evaluation ===")print("Accuracy:", accuracy_score(y_test, y_pred))print("Confusion Matrix:\n", confusion_matrix(y_test, y_pred))print("Classification Report:\n", classification_report(y_test, y_pred))# -----------------------------# Step 6: Visualize Logistic Curve# -----------------------------# Generate smooth values for plotting curvex_values = np.linspace(0, 10, 100).reshape(-1, 1)y_values = model.predict_proba(x_values)[:, 1]plt.scatter(x, y, color='red', label='Actual Data')plt.plot(x_values, y_values, color='blue', label='Logistic Regression Curve')plt.xlabel('Hours Studied')plt.ylabel('Probability of Passing')plt.title('Logistic Regression Model')plt.legend()plt.show()
# -----------------------------# Step 7: Predict for a New Value# -----------------------------hours = 7prob = model.predict_proba([[hours]])[0][1]pred = model.predict([[hours]])[0]print(f"\nFor {hours} hours of study:")print(f"Predicted Probability of Passing: {prob:.2f}")print(f"Predicted Class (0=Fail, 1=Pass): {pred}")
